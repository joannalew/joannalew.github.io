<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name = "viewport" content = "width=device-width, initial-scale=1.0">

		<title>Reddit API Tutorial</title>
		
		<link href = "css/bootstrap.min.css" rel = "stylesheet">
		<link href = "css/styles.css" rel = "stylesheet">
	</head>

	<body>

	<!-- Navbar -->
		<div class = "navbar navbar-default navbar-static-top">
			<div class = "container">
				<a href = "index.html" class = "navbar-brand">Reddit API Tutorial</a>
				
				<button class = "navbar-toggle" data-toggle = "collapse" data-target = ".navHeaderCollapse">
					<span class = "icon-bar"></span>
					<span class = "icon-bar"></span>
					<span class = "icon-bar"></span>
				</button>
				
				<div class = "collapse navbar-collapse navHeaderCollapse">
					<ul class = "nav navbar-nav navbar-left">
						<li class = "dropdown">
						<a href = "#" class = "dropdown-toggle" data-toggle = "dropdown">Navigation<b class = "caret"></b></a>
							<ul class = "dropdown-menu">
								<li><a href = "page2.html">Getting an API Key</a></li>
								<li><a href = "page3.html">Using Command Line</a></li>
								<li><a href = "page4.html">Using Snoocore</a></li>
								<li><a href = "page5.html">Making a Post</a></li>
								<li><a href = "page6.html">Upvoting a Post</a></li>
								<li><a href = "page7.html">Making the Bot</a></li>
							</ul>
						</li>
						<li><a href = "https://www.reddit.com/dev/api">Reddit API</a></li>
						<li><a href = "https://github.com/trevorsenior/snoocore">Snoocore</a></li>
						<li><a href = "https://nodejs.org/en/">Node.js</a></li>
					</ul>
				</div>

			</div>
		</div>

	
	<!-- Jumbotron -->
	<div class = "container">
		<div class = "jumbotron">
			<div><h1>Upvoting Posts on Reddit</h1></div>
			<p></p>
			<p>We now know how to make posts on Reddit, but what's that? You want to never post anything and want to just laze and lurk? Well, we can do that too!</p>
			
			<p>Here is the code for upvoting the fourth post on the second page of <a href="http://askreddit.reddit.com/">/r/AskReddit</a>.</p>
			<iframe width="100%" height="300" src="https://jsfiddle.net/joanna4649/77pmkbzL/3/embedded/js/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
			<p></p>

			<p>The initialization and login process is the same as before. What's new is the scope. Since we are using <a href="https://www.reddit.com/dev/api/#GET_api_v1_me">/api/v1/me</a>, we will need <code>identity</code> in the scope. Requesting a subreddit's hot page with <a href="https://www.reddit.com/dev/api/oauth#GET_hot">/r/subreddit/hot</a> requires <code>read</code> in the scope. We are also using <a href="https://www.reddit.com/dev/api/#POST_api_vote">/api/vote</a>, which requires <code>vote</code> in the scope.</p>

			<p>We go to the Subreddit of our choosing by getting a promise for a listing of that Subreddit with the code, <code>reddit('/r/askreddit/hot').listing();</code>. We go to a certain page on that Subreddit depending on how many times we write the code <code>  return slice.next();</code>. Since we want to go to the second page, we call it once. We can call it again to move to the third page. Note that a <code>slice</code> is 25 posts, which is the default posts per page for a Reddit account. If this value is changed for your account, running the code may cause a different post to be upvoted.</p>

			<p>We choose which post on that page to upvote using <code>slice.children[index]</code>. It is numbered as an array, so the first post has an index value of 0, the second post has an index value of 1, and so on. In our case, since we want to upvote the fourth post, we put in an index value of 3. We save the post as <code>upvoteThis</code> to use later.</p>

			<p>The upvoting is done by a POST request using <a href="https://www.reddit.com/dev/api/#POST_api_vote">/api/vote</a>. Once again, we can consult the API documentation to figure out what parameters we need and what values they should be. Below is the part of the documentation we're presently concerned with.</p>

			<img src="img/img6-1.png" class="img-responsive">
			<p id="hotfix1">p</p>

			<p>According to the documentation, dir is given a value of 1 to upvote, 0 to cancel any upvotes or downvotes, and -1 to downvote. We want to upvote a post, so we pass it a value of 1.</p>

			<p>To get the fullname of a post, we must know the type of post it is (link or text) and its unique ID. The fullname is in the format type, underscore, ID. For example, a link post might have the fullname t3_15bfi0, with t3 indicating it is a link post, and 15bfi0 being its unique ID. We pass the fullname (<code>upvoteThis.kind + '_' + upvoteThis.data.id</code>) to the parameter id, in order to indicate which post to upvote.</p>

			<p>And that's all there is to it! Let's look at the result. Check that the post was indeed upvoted by going to the second page of <a href="https://www.reddit.com/r/AskReddit/">/r/AskReddit</a>.</p>
			
			<img src="img/img6-2.png" class="img-responsive">
			<p id="hotfix1">p</p>

			<p>We can also confirm that the action occurred by checking the console. We log to console our username, the title of the post we upvoted, and the URL of the post.</p>

			<img src="img/img6-3.png" class="img-responsive">
			<p id="hotfix1">p</p>
			
			<p>Now we can post or lurk to our heart's content using Reddit's API! One last thing to be aware of is that by default, accounts do not show posts marked age 18+. The script above goes through all posts, including age 18+ posts. To ensure consistency between expected and actual results, accounts should display posts marked age 18+. You can change the option to display or not display such posts in <a href="https://www.reddit.com/prefs/">preferences</a>, under content options, first box.</p>

			<p id="hotfix1">p</p>
			<p><a href = "page5.html" class = "btn btn-lg btn-default">&laquo; Previous</a> <a href = "page7.html" class = "btn btn-lg btn-primary">Next &raquo;</a></p>
		</div>
		</div>
	</div>



	<!-- Footer -->
	<div class = "navbar navbar-default navbar-fixed-bottom">
		<div class = "container">
			<p class = "navbar-text pull-left">Written by Joanna Lew</p>
		</div>
	</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script src="js/bootstrap.js"></script>


	</body>
</html>
